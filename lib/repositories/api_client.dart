/// Author: Duc Trung Nguyen
/// Created: 29/03/2021
/// Project: ohmalware

import 'package:dio/dio.dart';
import 'package:ohmalware/commons/constant.dart';
import 'package:ohmalware/models/app_scan_model.dart';
import 'package:ohmalware/models/result_app_scan_model.dart';
import 'package:ohmalware/modules/home/controllers/mock_data.dart';
import 'package:ohmalware/repositories/api_interface.dart';
import 'package:http/http.dart' as http;
import 'dart:convert';
// import '';

class ApiClient extends ApiInterface {
  var dio = Dio(); // with default Options

  ApiClient() {
    dio.options.baseUrl = '$BASE_URL';
  }

  @override
  Future<List<ResultAppScanModel>> uploadScan(
      Map<String, dynamic> listAppScanModel) async {
    final listResult = <ResultAppScanModel>[];
    try {

      final result = await dio.post(
        '/scan_featured/',
        data: jsonEncode(listAppScanModel),
        options: Options(
            headers: {'content-Type': 'application/json'},
            followRedirects: false,
            validateStatus: (status) {
              return status < 500;
            }),
      );





      // mock_data.forEach((key, value) { })

      // List.of(mock_data['data']).forEach((element) {
      //   listResult.add(ResultAppScanModel.fromJson(element));
      // });
      //
      // return listResult;


      if (result.data['status'] == 200) {
        var list = result.data['data'];


        result.data['data'].forEach((element) {
          listResult.add(ResultAppScanModel.fromJson(element));
        });

        return listResult;
      } else {
        return <ResultAppScanModel>[];
      }
    } catch (ex) {
      print(ex);
      return <ResultAppScanModel>[];
    }
    // http://222.252.17.225/scan_featured/
  }

  Future<void> IndexHome() async {
    try {
      // final response = await http.get(Uri.http('222.252.17.225',''));
      final result = await Dio().get('http://222.252.17.225/');
      var a = 1;
    } catch (ex) {
      return <ResultAppScanModel>[];
    }
  }
}

ApiClient apiClient = ApiClient();
